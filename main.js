(()=>{"use strict";const e=e=>{const t=e;let a=[];(()=>{for(let e=0;e<t;e++)a.push("")})();const r=()=>a.every((e=>"hit"===e));return{length:t,hitSpots:a,hit:e=>{a[e]="hit",r()},isSunk:r}},t=()=>{const t=[];let a="horizontal";const r=[],s=[];let o=[];const n=(e,t)=>o.some((a=>e.includes(a[0])&&t.includes(a[1])));return{place:(r,s,l)=>{if("horizontal"==a){const a=e(r),i=[],c=[];return(()=>{for(let e=0;e<a.length;e++)i.push(s+e);c.push(l)})(),n(i,c)||s+r>10?"failed":(t.push({locationsH:i,locationsV:c,newShip:a}),o.push([s-1,l]),o.push([s+r,l]),i.forEach((e=>{o.push([e,c[0]])})),i.forEach((e=>{o.push([e,c[0]-1])})),i.forEach((e=>{o.push([e,c[0]+1])})),"placed")}if("vertical"==a){const a=e(r),i=[],c=[];return(()=>{i.push(s);for(let e=0;e<a.length;e++)c.push(l+e)})(),n(i,c)||l+r>10?"failed":(t.push({locationsH:i,locationsV:c,newShip:a}),o.push([s,l-1]),o.push([s,l+r]),c.forEach((e=>{o.push([i[0],e])})),c.forEach((e=>{o.push([i[0]-1,e])})),c.forEach((e=>{o.push([i[0]+1,e])})),"placed")}},change:function(){return"vertical"!=a?(a="vertical","vertical"):(a="horizontal","horizontal")},receiveAttack:(e,a)=>{let o,n;return o=t.find((t=>t.locationsH.includes(e)&&t.locationsV.includes(a))),null==o?(s.push([e,a]),r.push([e,a]),"miss"):1==o.locationsV.length?(n=o.locationsH.findIndex((t=>t==e)),o.newShip.hit(n),s.push([e,a]),"hit"):(n=o.locationsV.findIndex((e=>e==a)),o.newShip.hit(n),s.push([e,a]),"hit")},allSunk:()=>!(!t.every((e=>e.newShip.isSunk()))||!t[0]),checkCollision:n,shot:r,missed:s,ships:t,arrangement:a,occupied:o}};function a(e){const t=Array.from(document.querySelectorAll(".player-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,r=e.locationsV,s=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&r.includes(parseInt(e.attributes[2].value))));s.forEach((e=>e.classList.add("occupied"))),e.newShip.isSunk()&&s.forEach((e=>e.classList.add("down")))}))}const r={turn:(e,t,a)=>e.gameboard.receiveAttack(t,a),gameboard:t()};t(),(()=>{const e=document.querySelector(".player-board"),t=document.querySelector(".computer-board");for(let a=0;a<10;a++)for(let r=0;r<10;r++){const s=document.createElement("div"),o=document.createElement("div");s.classList.add("cell"),s.setAttribute("x",r),s.setAttribute("y",a),e.appendChild(s),o.classList.add("cell"),o.setAttribute("x",r),o.setAttribute("y",a),t.appendChild(o)}})(),a(r),function(e){const t=Array.from(document.querySelectorAll(".player-board > .cell")),r=document.querySelector(".vs"),s=document.querySelector(".s"),o=document.querySelector(".m"),n=document.querySelector(".l");let l=0,i=0,c=0,d=0,h=0;function u(e){e.dataTransfer.setData("text/plain",this.getAttribute("length")),l=parseInt(this.getAttribute("length"))}function p(t){const a=Array.from(this.getAttribute("x")).map((e=>parseInt(e))),r=Array.from(this.getAttribute("y")).map((e=>parseInt(e)));if(l>1)for(let e=1;e<l;e++)a.push(a[0]+e);const s=e.gameboard.checkCollision(a,r);a.length>r.length?0==s?a.forEach((e=>{document.querySelector(`.player-board > div[x="${e}"][y="${r[0]}"]`).classList.add("valid")})):a.forEach((e=>{document.querySelector(`.player-board > div[x="${e}"][y="${r[0]}"]`).classList.add("invalid")})):a.length<r.length?0==s?r.forEach((e=>{document.querySelector(`.player-board > div[x="${a[0]}"][y="${e}"]`).classList.add("valid")})):r.forEach((e=>{document.querySelector(`.player-board > div[x="${a[0]}"][y="${e}"]`).classList.add("invalid")})):0==s?this.classList.add("valid"):this.classList.add("invalid"),t.preventDefault()}function m(e){const t=Array.from(this.getAttribute("x")).map((e=>parseInt(e))),a=Array.from(this.getAttribute("y")).map((e=>parseInt(e)));if(l>1)for(let e=1;e<l;e++)t.push(t[0]+e);t.length>a.length?t.forEach((e=>{document.querySelector(`.player-board > div[x="${e}"][y="${a[0]}"]`).classList.remove("valid","invalid")})):t.length<a.length?a.forEach((e=>{document.querySelector(`.player-board > div[x="${t[0]}"][y="${e}"]`).classList.remove("valid","invalid")})):this.classList.remove("valid","invalid")}function f(r){const s=parseInt(this.getAttribute("x")),o=parseInt(this.getAttribute("y")),n=e.gameboard.checkCollision([s],[o]),l=parseInt(r.dataTransfer.getData("text/plain"));0==n&&1==l&&i<4?(e.gameboard.place(1,s,o),i++):1==l&&4==i?console.log("cant't place more than 4   very small ships!"):0==n&&2==l&&c<3?(e.gameboard.place(2,s,o),c++):2==l&&3==c?console.log("cant't place more than 3 small ships!"):0==n&&3==l&&d<2?(e.gameboard.place(3,s,o),d++):2==l&&2==d?console.log("cant't place more than 2 medium ships!"):0==n&&4==l&&h<1?(e.gameboard.place(4,s,o),h++):2==l&&2==d&&console.log("cant't place more than 1 large ships!"),t.forEach((e=>{e.classList.remove("valid","invalid")})),a(e)}r.addEventListener("dragstart",u),s.addEventListener("dragstart",u),o.addEventListener("dragstart",u),n.addEventListener("dragstart",u),t.forEach((e=>{e.addEventListener("dragleave",m)})),t.forEach((e=>{e.addEventListener("dragover",p)})),t.forEach((e=>{e.addEventListener("drop",f)}))}(r)})();