(()=>{"use strict";const e=e=>{const t=e;let a=[];(()=>{for(let e=0;e<t;e++)a.push("")})();const o=()=>a.every((e=>"hit"===e));return{length:t,hitSpots:a,hit:e=>{a[e]="hit",o()},isSunk:o}},t=()=>{const t=[];let a="horizontal";const o=[],r=[];let l=[];const s=(e,t)=>l.some((a=>e.includes(a[0])&&t.includes(a[1])));return{place:(o,r,c)=>{if("horizontal"==a){const a=e(o),n=[],i=[];return(()=>{for(let e=0;e<a.length;e++)n.push(r+e);i.push(c)})(),s(n,i)||r+o>9?"failed":(t.push({locationsH:n,locationsV:i,newShip:a}),l.push([r-1,c]),l.push([r+o,c]),n.forEach((e=>{l.push([e,i[0]])})),n.forEach((e=>{l.push([e,i[0]-1])})),n.forEach((e=>{l.push([e,i[0]+1])})),"placed")}if("vertical"==a){const a=e(o),n=[],i=[];if((()=>{n.push(r);for(let e=0;e<a.length;e++)i.push(c+e)})(),s(n,i))return"failed";if(c+o>9)return"failed";t.push({locationsH:n,locationsV:i,newShip:a}),l.push([r,c-1]),l.push([r,c+o]),i.forEach((e=>{l.push([n[0],e])})),i.forEach((e=>{l.push([n[0]-1,e])})),i.forEach((e=>{l.push([n[0]+1,e])}))}},change:function(){a="vertical"!=a?"vertical":"horizontal"},receiveAttack:(e,a)=>{let l,s;return l=t.find((t=>t.locationsH.includes(e)&&t.locationsV.includes(a))),null==l?(r.push([e,a]),o.push([e,a]),"miss"):1==l.locationsV.length?(s=l.locationsH.findIndex((t=>t==e)),l.newShip.hit(s),r.push([e,a]),"hit"):(s=l.locationsV.findIndex((e=>e==a)),l.newShip.hit(s),r.push([e,a]),"hit")},allSunk:()=>!!t.every((e=>e.newShip.isSunk())),checkCollision:s,shot:o,missed:r,ships:t,arrangement:a,occupied:l}},a=(e,t)=>{const o=Array.from(document.querySelectorAll(".player-board > .cell"));let r=e.turn(t);const l=o.find((e=>e.attributes[1].value==r[1]&&e.attributes[2].value==r[2]));return"miss"==r[0]?l.classList.add("miss"):"hit"==r[0]&&(l.classList.add("hit"),a(e,t)),r[0]};(()=>{(()=>{const e=document.querySelector(".player-board"),t=document.querySelector(".computer-board");for(let a=0;a<10;a++)for(let o=0;o<10;o++){const r=document.createElement("div"),l=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",o),r.setAttribute("y",a),e.appendChild(r),l.classList.add("cell"),l.setAttribute("x",o),l.setAttribute("y",a),t.appendChild(l)}})();const e={turn:(e,t,a)=>e.gameboard.receiveAttack(t,a),gameboard:t()},o=(()=>{const e=t();return{turn:e=>{let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const o=e=>e[0]==t&&e[1]==a;for(;e.gameboard.shot.some(o);)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());return[e.gameboard.receiveAttack(t,a),t,a]},gameboard:e,placeVerySmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(1,a,o)&&t++}while(t<4)},placeSmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(2,a,o)?t++:e.change()}while(t<3)},placeMediumShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(3,a,o)&&t++}while(t<2)},placeLargeShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(4,a,o)?t++:e.change()}while(1!=t)}}})();e.gameboard.place(4,6,7),o.placeVerySmallShips(),o.placeSmallShips(),o.placeMediumShips(),o.placeLargeShips(),function(e){const t=Array.from(document.querySelectorAll(".player-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,o=e.locationsV,r=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&o.includes(parseInt(e.attributes[2].value))));r.forEach((e=>e.classList.add("occupied")))}))}(e),function(e){const t=Array.from(document.querySelectorAll(".computer-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,o=e.locationsV,r=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&o.includes(parseInt(e.attributes[2].value))));r.forEach((e=>e.classList.add("occupied")))}))}(o),((e,t)=>{const o=document.querySelectorAll(".computer-board > .cell");function r(l){const s=parseInt(l.target.getAttribute("x")),c=parseInt(l.target.getAttribute("y")),n=e.turn(t,s,c);"hit"==n?l.target.classList.add("hit"):"miss"==n&&(l.target.classList.add("miss"),a(t,e)),(t.gameboard.allSunk()||e.gameboard.allSunk())&&(console.log("done!"),o.forEach((e=>{e.removeEventListener("click",r)}))),l.target.removeEventListener("click",r)}(t.gameboard.allSunk()||e.gameboard.allSunk())&&o.forEach((e=>{e.removeEventListener("click",r)})),o.forEach((e=>{e.addEventListener("click",r)}))})(e,o),o.gameboard.occupied.forEach((e=>{const t=e[0],a=e[1];let o=document.querySelector(`.computer-board > [x="${t}"][y="${a}"]`);o&&(o.textContent="X")}))})()})();