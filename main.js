(()=>{"use strict";const e=e=>{const t=e;let a=[];(()=>{for(let e=0;e<t;e++)a.push("")})();const o=()=>a.every((e=>"hit"===e));return{length:t,hitSpots:a,hit:e=>{a[e]="hit",o()},isSunk:o}},t=()=>{const t=[];let a="horizontal";const o=[],l=[];let r=[];const s=(e,t)=>r.some((a=>e.includes(a[0])&&t.includes(a[1])));return{place:(o,l,n)=>{if("horizontal"==a){const a=e(o),c=[],i=[];return(()=>{for(let e=0;e<a.length;e++)c.push(l+e);i.push(n)})(),s(c,i)||l+o>10?"failed":(t.push({locationsH:c,locationsV:i,newShip:a}),r.push([l-1,n]),r.push([l+o,n]),c.forEach((e=>{r.push([e,i[0]])})),c.forEach((e=>{r.push([e,i[0]-1])})),c.forEach((e=>{r.push([e,i[0]+1])})),"placed")}if("vertical"==a){const a=e(o),c=[],i=[];if((()=>{c.push(l);for(let e=0;e<a.length;e++)i.push(n+e)})(),s(c,i))return"failed";if(n+o>10)return"failed";t.push({locationsH:c,locationsV:i,newShip:a}),r.push([l,n-1]),r.push([l,n+o]),i.forEach((e=>{r.push([c[0],e])})),i.forEach((e=>{r.push([c[0]-1,e])})),i.forEach((e=>{r.push([c[0]+1,e])}))}},change:function(){a="vertical"!=a?"vertical":"horizontal"},receiveAttack:(e,a)=>{let r,s;return r=t.find((t=>t.locationsH.includes(e)&&t.locationsV.includes(a))),null==r?(l.push([e,a]),o.push([e,a]),"miss"):1==r.locationsV.length?(s=r.locationsH.findIndex((t=>t==e)),r.newShip.hit(s),l.push([e,a]),"hit"):(s=r.locationsV.findIndex((e=>e==a)),r.newShip.hit(s),l.push([e,a]),"hit")},allSunk:()=>!!t.every((e=>e.newShip.isSunk())),checkCollision:s,shot:o,missed:l,ships:t,arrangement:a,occupied:r}},a=(e,t)=>{const o=Array.from(document.querySelectorAll(".player-board > .cell"));let l=e.turn(t);const r=o.find((e=>e.attributes[1].value==l[1]&&e.attributes[2].value==l[2]));return"miss"==l[0]?r.classList.add("miss"):"hit"==l[0]&&(r.classList.add("hit"),a(e,t)),l[0]},o={turn:(e,t,a)=>e.gameboard.receiveAttack(t,a),gameboard:t()};o.gameboard.place(4,6,7),(()=>{(()=>{const e=document.querySelector(".player-board"),t=document.querySelector(".computer-board");for(let a=0;a<10;a++)for(let o=0;o<10;o++){const l=document.createElement("div"),r=document.createElement("div");l.classList.add("cell"),l.setAttribute("x",o),l.setAttribute("y",a),e.appendChild(l),r.classList.add("cell"),r.setAttribute("x",o),r.setAttribute("y",a),t.appendChild(r)}})();const e=(()=>{const e=t();return{turn:e=>{let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const o=e=>e[0]==t&&e[1]==a;for(;e.gameboard.shot.some(o);)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());return[e.gameboard.receiveAttack(t,a),t,a]},gameboard:e,placeVerySmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(1,a,o)&&t++}while(t<4)},placeSmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(2,a,o)?t++:e.change()}while(t<3)},placeMediumShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(3,a,o)&&t++}while(t<2)},placeLargeShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());"failed"!=e.place(4,a,o)?t++:e.change()}while(1!=t)}}})();e.placeVerySmallShips(),e.placeSmallShips(),e.placeMediumShips(),e.placeLargeShips(),function(e){const t=Array.from(document.querySelectorAll(".player-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,o=e.locationsV,l=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&o.includes(parseInt(e.attributes[2].value))));l.forEach((e=>e.classList.add("occupied")))}))}(o),((e,t)=>{const o=document.querySelectorAll(".computer-board > .cell");function l(r){const s=parseInt(r.target.getAttribute("x")),n=parseInt(r.target.getAttribute("y")),c=e.turn(t,s,n);"hit"==c?r.target.classList.add("hit"):"miss"==c&&(r.target.classList.add("miss"),a(t,e)),(t.gameboard.allSunk()||e.gameboard.allSunk())&&(console.log("done!"),o.forEach((e=>{e.removeEventListener("click",l)}))),r.target.removeEventListener("click",l)}(t.gameboard.allSunk()||e.gameboard.allSunk())&&o.forEach((e=>{e.removeEventListener("click",l)})),o.forEach((e=>{e.addEventListener("click",l)}))})(o,e)})()})();