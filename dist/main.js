(()=>{"use strict";const e=e=>{const t=e;let a=[];(()=>{for(let e=0;e<t;e++)a.push("")})();const r=()=>a.every((e=>"hit"===e));return{length:t,hitSpots:a,hit:e=>{a[e]="hit",r()},isSunk:r}},t=()=>{const t=[];let a="horizontal";const r=[],l=[];let o=[];const n=(e,t)=>o.some((a=>e.includes(a[0])&&t.includes(a[1])));return{place:(r,l,c)=>{if("horizontal"==a){const a=e(r),s=[],i=[];return(()=>{for(let e=0;e<a.length;e++)s.push(l+e);i.push(c)})(),n(s,i)||l+r>10?"failed":(t.push({locationsH:s,locationsV:i,newShip:a}),o.push([l-1,c]),o.push([l+r,c]),s.forEach((e=>{o.push([e,i[0]])})),s.forEach((e=>{o.push([e,i[0]-1])})),s.forEach((e=>{o.push([e,i[0]+1])})),"placed")}if("vertical"==a){const a=e(r),s=[],i=[];return(()=>{s.push(l);for(let e=0;e<a.length;e++)i.push(c+e)})(),n(s,i)||c+r>10?"failed":(t.push({locationsH:s,locationsV:i,newShip:a}),o.push([l,c-1]),o.push([l,c+r]),i.forEach((e=>{o.push([s[0],e])})),i.forEach((e=>{o.push([s[0]-1,e])})),i.forEach((e=>{o.push([s[0]+1,e])})),"placed")}},change:function(){return"vertical"!=a?(a="vertical","vertical"):(a="horizontal","horizontal")},receiveAttack:(e,a)=>{let o,n;return o=t.find((t=>t.locationsH.includes(e)&&t.locationsV.includes(a))),null==o?(l.push([e,a]),r.push([e,a]),"miss"):1==o.locationsV.length?(n=o.locationsH.findIndex((t=>t==e)),o.newShip.hit(n),l.push([e,a]),"hit"):(n=o.locationsV.findIndex((e=>e==a)),o.newShip.hit(n),l.push([e,a]),"hit")},allSunk:()=>!(!t.every((e=>e.newShip.isSunk()))||!t[0]),checkCollision:n,shot:r,missed:l,ships:t,arrangement:a,occupied:o}};function a(e){const t=Array.from(document.querySelectorAll(".computer-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,r=e.locationsV,l=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&r.includes(parseInt(e.attributes[2].value))));l.forEach((e=>e.classList.add("occupied"))),e.newShip.isSunk()&&l.forEach((e=>e.classList.add("down")))}))}const r=(e,t)=>{const a=Array.from(document.querySelectorAll(".player-board > .cell"));let l=e.turn(t);const o=a.find((e=>e.attributes[1].value==l[1]&&e.attributes[2].value==l[2]));return"miss"==l[0]?o.classList.add("miss"):"hit"==l[0]&&(o.classList.add("hit"),r(e,t)),l[0]},l={turn:(e,t,a)=>e.gameboard.receiveAttack(t,a),gameboard:t()},o=(()=>{const e=t();return{turn:e=>{if(!e.gameboard.allSunk()){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const r=e=>e[0]==t&&e[1]==a;for(;e.gameboard.shot.some(r);)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());return[e.gameboard.receiveAttack(t,a),t,a]}},gameboard:e,placeVerySmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());"failed"!=e.place(1,a,r)&&t++}while(t<4)},placeSmallShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());"failed"!=e.place(2,a,r)?t++:e.change()}while(t<3)},placeMediumShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());"failed"!=e.place(3,a,r)&&t++}while(t<2)},placeLargeShips:()=>{let t=0;do{let a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());"failed"!=e.place(4,a,r)?t++:e.change()}while(1!=t)}}})();(()=>{const e=document.querySelector(".player-board"),t=document.querySelector(".computer-board");for(let a=0;a<10;a++)for(let r=0;r<10;r++){const l=document.createElement("div"),o=document.createElement("div");l.classList.add("cell"),l.setAttribute("x",r),l.setAttribute("y",a),e.appendChild(l),o.classList.add("cell"),o.setAttribute("x",r),o.setAttribute("y",a),t.appendChild(o)}})(),o.placeVerySmallShips(),o.placeSmallShips(),o.placeMediumShips(),o.placeLargeShips(),a(o),document.querySelector('input[name="length"]').checked=!0,((e,t)=>{let l=document.querySelectorAll('input[name="length"]'),o=1;l.forEach((e=>{e.addEventListener("change",(e=>{o=parseInt(e.target.value)}))}));const n=(()=>{const e=document.querySelector(".display");return{updatePlacing:(t,a,r,l)=>{e.innerHTML="",e.innerHTML=`<p>1 cell ships placed: ${t}<p><br><p>2 cells ships placed: ${a}<p><br><p>3 cells ships placed: ${r}<p><br><p>4 cell ships placed: ${l}<p><br>`}}})();let c=0,s=0,i=0,d=0;function u(l){const p=parseInt(l.target.getAttribute("x")),m=parseInt(l.target.getAttribute("y"));if(1==o&&c<4){if("placed"!=e.gameboard.place(o,p,m))return;c++,l.target.removeEventListener("click",u),n.updatePlacing(c,s,i,d)}else if(2==o&&s<3){if("placed"!=e.gameboard.place(o,p,m))return;s++,l.target.removeEventListener("click",u),n.updatePlacing(c,s,i,d)}else if(3==o&&i<2){if("placed"!=e.gameboard.place(o,p,m))return;i++,l.target.removeEventListener("click",u),n.updatePlacing(c,s,i,d)}else if(4==o&&d<1){if("placed"!=e.gameboard.place(o,p,m))return;d++,l.target.removeEventListener("click",u),n.updatePlacing(c,s,i,d)}4==c&&3==s&&2==i&&1==d&&(h.forEach((e=>{e.removeEventListener("click",u)})),((e,t)=>{const l=document.querySelectorAll(".computer-board > .cell");function o(n){const c=parseInt(n.target.getAttribute("x")),s=parseInt(n.target.getAttribute("y")),i=e.turn(t,c,s);"hit"==i?n.target.classList.add("hit"):"miss"==i&&(n.target.classList.add("miss"),r(t,e)),e.gameboard.allSunk()&&e.gameboard.ships[0].newShip.isSunk()?(console.log("computer won"),l.forEach((e=>{e.removeEventListener("click",o)}))):t.gameboard.allSunk()&&t.gameboard.ships[0].newShip.isSunk()&&(console.log("player won"),l.forEach((e=>{e.removeEventListener("click",o)}))),a(t),n.target.removeEventListener("click",o)}(t.gameboard.allSunk()||e.gameboard.allSunk())&&l.forEach((e=>{e.removeEventListener("click",o)})),l.forEach((e=>{e.addEventListener("click",o)}))})(e,t)),function(e){const t=Array.from(document.querySelectorAll(".player-board > .cell"));e.gameboard.ships.forEach((e=>{const a=e.locationsH,r=e.locationsV,l=t.filter((e=>a.includes(parseInt(e.attributes[1].value))&&r.includes(parseInt(e.attributes[2].value))));l.forEach((e=>e.classList.add("occupied"))),e.newShip.isSunk()&&l.forEach((e=>e.classList.add("down")))}))}(e)}const h=document.querySelectorAll(".player-board > .cell");h.forEach((e=>{e.addEventListener("click",u)}))})(l,o),(e=>{const t=document.querySelector("#change-arrangement"),a=document.querySelector("#arrangement");a.textContent=e.gameboard.arrangament,t.addEventListener("click",(()=>{a.textContent=e.gameboard.change()}))})(l)})();